<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Flagaholic - Hong Kong based CTF team focusing on Web, Pwn, Crypto, Forensics, and Misc.">
  
  <link rel="apple-touch-icon" sizes="180x180" href="./assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="./assets/favicon/site.webmanifest">
  <meta name="msapplication-TileColor" content="#0f1720">
  <meta name="theme-color" content="#0f1720">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="./css/site.css">
  <link rel="stylesheet" href="./css/members.css">
  
  <title>Members â€” Flagaholic</title>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <img class="logo" src="./assets/teamlogo/teampfp.png" alt="Flagaholic" width="40" height="40" loading="eager" decoding="async">
        <strong>Flagaholic</strong>
      </div>
      <nav>
        <a href="./index.html">Home</a>
        <a href="./members.html">Members</a>
        <a href="./achievements.html">Achievements</a>
        <a href="./writeups.html">Writeups</a>
        <a href="./contact.html">Contact</a>
      </nav>
    </header>
    
    <main class="main">
      <div class="card">
        <h1>Members</h1>
        <div class="members-grid">
          <!-- 
          <div class="member-card">
            <img src="./assets/playerlogo/{img}.jpg" alt="usr" class="member-avatar">
            <h3>usr</h3>
            <p class="member-role"> </p>
            <div class="member-skills">
              <span>skill</span>
            </div>
            <template class="socials-data">
            {
                "key": {
                    "url": "url",
                    "icon": "icon"
                }
            }
            </template>
          </div>
          -->
          <div class="member-card hk special" content="leader">
            <img src="./assets/playerlogo/youstube.jpg" alt="youstube_" class="member-avatar">
            <h3>youstube_</h3>
            <p class="member-role">Team Leader</p>
            <div class="member-skills">
              <span>Misc</span>
              <span>Forensics</span>
              <span>OSINT</span>
            </div>
            <template class="socials-data">
            {
                "github": {
                    "url": "https://github.com/codestube",
                    "username": "codestube"
                },
                "instagram": {
                    "url": "https://www.instagram.com/youstube__",
                    "username": "youstube__"
                }
            }
            </template>
          </div>
            
          <div class="member-card hk">
            <img src="./assets/playerlogo/kazuya.png" alt="Kazuya" class="member-avatar">
            <h3>Kazuya</h3>
            <p class="member-role">Former Former-teammate</p>
            <div class="member-skills">
              <span>Rev</span>
              <span>Web</span>
            </div>
          </div>

          <div class="member-card hk">
            <img src="./assets/playerlogo/thomas.png" alt="bug1nst0m@ch" class="member-avatar">
            <h3>bug1nst0m@ch</h3>
            <p class="member-role">Not even computer major</p>
            <div class="member-skills">
              <span>Misc</span>
              <span>Forensics</span>
            </div>
          </div>
          
          <div class="member-card hk">
            <img src="./assets/playerlogo/OwO.png" alt="sunny7890987" class="member-avatar">
            <h3>OWO</h3>
            <p class="member-role"> Anon Chihaya </p>
            <div class="member-skills">
              <span>Web</span>
            </div>
          </div>
          
          <div class="member-card hk">
            <img src="./assets/playerlogo/NSN.png" alt="Nsn" class="member-avatar">
            <h3>Nsn</h3>
            <p class="member-role"> </p>
            <div class="member-skills">
              <span>Hardware</span>
            </div>
          </div>
          
          <div class="member-card hk special" content="dumbass">
            <img src="./assets/playerlogo/taokyle.jpeg" alt="Taokyle" class="member-avatar">
            <h3>Taokyle</h3>
            <p class="member-role">website maintainer</p>
            <div class="member-skills">
              <span>Misc</span>
              <span>Web</span>
              <span>Forensics</span>
            </div>
            <template class="socials-data">
            {
                "github": {
                    "url": "https://github.com/TaokyleYT",
                    "username": "TaokyleYT"
                },
                "instagram": {
                    "url": "https://www.instagram.com/taokyle415",
                    "username": "taokyle415"
                }
            }
            </template>
          </div>
          
          <div class="member-card hk special" content="english level U">
            <img src="./assets/playerlogo/sisubeny.png" alt="SISUBENY" class="member-avatar">
            <h3>SISUBENY</h3>
            <p class="member-role"> </p>
            <div class="member-skills">
              <span>Rev</span>
              <span>Pwn</span>
            </div>
            <template class="socials-data">
            {
                "github": {
                    "url": "https://github.com/SISUBEN",
                    "username": "SISUBEN"
                },
                "twitter": {
                    "url": "https://x.com/SISUBENY",
                    "username": "SISUBENY"
                },
                "blog": {
                    "url": "https://sisubeny.space"
                }
            }
            </template>
          </div>
          
          <div class="member-card hk special" content="roblox lover">
            <img src="./assets/playerlogo/twopus.png" alt="twopus" class="member-avatar">
            <h3>twopus</h3>
            <p class="member-role">differentiating "ur" & "ure"</p>
            <div class="member-skills">
              <span>Uhh</span>
            </div>
            <template class="socials-data">
            {
                "github": {
                    "url": "https://github.com/twopus",
                    "username": "twopus"
                }
            }
            </template>
          </div>

          <div class="member-card hk special" content="A Snorlax?">
            <img src="./assets/playerlogo/harrybob.jpg" alt="harrybob" class="member-avatar">
            <h3>HarryBOB</h3>
            <p class="member-role"> </p>
            <div class="member-skills">
              <span>Blockchain</span>
            </div>
            <template class="socials-data">
            {
                "github": {
                    "url": "https://github.com/harry-bob",
                    "username": "harry-bob"
                }
            }
            </template>
          </div>

          <div class="member-card hk special" content="KA CHOW!">
            <img src="./assets/playerlogo/carz.jpeg" alt="carz" class="member-avatar">
            <h3>Carz</h3>
            <p class="member-role">a car</p>
            <div class="member-skills">
              <span>Crypto</span>
              <span>Forensics</span>
            </div>
          </div>
          
          <div class="member-card nonhk">
            <img src="./assets/playerlogo/Nelson.jpg" alt="Nelson" class="member-avatar">
            <h3>xzhiyouu(Nelson)</h3>
            <p class="member-role"> </p>
            <div class="member-skills">
              <span>Misc</span>
              <span>Forensics</span>
            </div>
            <template class="socials-data">
            {
                "github": {
                    "url": "https://github.com/xzhiyouu62",
                    "username": "xzhiyouu62"
                }
            }
            </template>
          </div>
          
          <div class="member-card nonhk">
            <img src="./assets/playerlogo/demonster.png" alt="Demonster" class="member-avatar">
            <h3>Demonster</h3>
            <p class="member-role">Raccoon goes maur maur</p>
            <div class="member-skills">
              <span>Web</span>
            </div>
            <template class="socials-data">
            {
                "key": {
                    "url": "https://www.linkedin.com/in/daniel-agatan/",
                    "icon": "daniel-agatan"
                }
            }
            </template>
          </div>
          
          <div class="member-card nonhk">
            <img src="./assets/playerlogo/B34RN00B.png" alt="B34RN00B" class="member-avatar">
            <h3>B34RN00B</h3>
            <p class="member-role"> </p>
            <div class="member-skills">
              <span>OSINT</span>
              <span>Forensics</span>
            </div>
            <template class="socials-data">
            {
                "discord": {
                    "username": "b34rn00by",
                    "url": "https://discord.com/users/1379831907784855712"
                }
            }
            </template>
          </div>
          
          <div class="member-card nonhk">
            <img src="./assets/playerlogo/damwan.jpg" alt="damwan21" class="member-avatar">
            <h3>damwan21</h3>
            <p class="member-role"> </p>
            <div class="member-skills">
              <span>OSINT</span>
              <span>Crypto</span>
            </div>
          </div>
          

        </div>
      </div>
    </main>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', (async function () {
    // simple in-memory cache to avoid refetching same favicons
    const iconCache = new Map();

    function desiredSizeFromUrl(src) {
      try {
        const m = src.match(/[?&](?:sz|size)=([0-9]+)/i);
        return m ? parseInt(m[1], 10) : null;
      } catch (e) { return null; }
    }

    async function fetchFavicon(src, timeout = 2500) {
      if (!src) return null;
      // cache hit (successful src)
      if (iconCache.has(src)) {
        return iconCache.get(src);
      }

      return await new Promise((resolve) => {
        try {
          const img = new Image();
          let done = false;
          const finish = (res) => { if (!done) { done = true; resolve(res); } };
          const t = setTimeout(() => finish(null), timeout);

          img.onload = () => {
            clearTimeout(t);
            try {
              const w = img.naturalWidth || img.width || 32;
              const h = img.naturalHeight || img.height || 32;
              const desired = desiredSizeFromUrl(src);
              // if size param specified, require exact match
              if (desired && (w !== desired || h !== desired)) {
                finish(null);
                return;
              }
              const result = { src, w, h };
              iconCache.set(src, result);
              finish(result);
            } catch (err) { finish(null); }
          };

          img.onerror = () => { clearTimeout(t); finish(null); };
          // Do NOT set img.crossOrigin ts made the icon fetches die
          img.src = src;
        } catch (e) { resolve(null); }
      });
    }

    // create an icon node (fallbacks to emoji)
    async function createIconNode(href, overrideIcon, fallbackEmoji) {
      const emojiEl = document.createElement('span');
      emojiEl.className = 'member-social-emoji';
      emojiEl.textContent = fallbackEmoji || 'ðŸ”—';

      const srcCandidates = [];
      if (overrideIcon) srcCandidates.push(overrideIcon);
      if (href) {
        try {
          // favicon sources (site favicon -> google s2 -> ddg -> favic.one)
          const u = new URL(href);
          srcCandidates.push(`${u.origin}/favicon.ico`);
          srcCandidates.push(`https://www.google.com/s2/favicons?domain=${u.hostname}&sz=64`);
          srcCandidates.push(`https://icons.duckduckgo.com/ip3/${u.hostname}.ico`);
          srcCandidates.push(`https://favic.one/api/favicon?url=${u.hostname}&size=64`);
        } catch (e) { }
      }

      for (const src of srcCandidates) {
        if (!src) continue;
        try {
          const info = await fetchFavicon(src);
          if (!info) continue;

          // create <img> using the successful src and style it
          const img = document.createElement('img');
          img.className = 'member-social-icon';
          img.alt = '';
          img.src = info.src;
          try {
            const w = info.w || 32;
            const h = info.h || 32;
            const tolerance = Math.max(2, Math.round(Math.min(w, h) * 0.06));
            img.style.borderRadius = (Math.abs(w - h) <= tolerance) ? '50%' : '8px';
            img.style.objectFit = 'cover';
          } catch (e) { }

          // Confirm it displays (short timeout)
          const ok = await new Promise((res) => {
            let done = false;
            const finish = (v) => { if (!done) { done = true; res(v); } };
            img.onload = () => finish(true);
            img.onerror = () => finish(false);
            setTimeout(() => finish(false), 1800);
          });

          if (ok) return img;
        } catch (e) { }
      }

      // nothing usable found -> fallback emoji
      return emojiEl;
    }

    function extractUsernameFromUrl(url) {
      try {
        // typical URL patterns
        const u = new URL(url);
        const host = u.hostname.replace(/^www\./, '').toLowerCase();
        const parts = u.pathname.replace(/\/+$/, '').split('/').filter(Boolean);
        if (host.includes('github.com') && parts[0]) return parts[0];
        if ((host.includes('twitter.com') || host.includes('x.com') || host.includes('t.co')) && parts[0]) return parts[0];
        if (host.includes('instagram.com') && parts[0]) return parts[0];
        if (host.includes('linkedin.com') && parts.includes('in')) {
          const idx = parts.indexOf('in'); if (parts[idx+1]) return parts[idx+1];
        }
        if (host.includes('mailto:')) return u.pathname;
        return null;
      } catch (e) { return null; }
    }

    // platform label templates, feel free to add more
    const PLATFORM_TEMPLATES = {
      github: '{username} @ GitHub',
      instagram: '@{username} (IG)',
      twitter: '@{username} (X)',
      discord: '{username}#{discriminator}',
      default: '{username}'
    };

    function formatLabel(platform, data, rawUrl) {
      const tpl = PLATFORM_TEMPLATES[platform] || PLATFORM_TEMPLATES.default;
      let label = tpl;
      if (data && typeof data === 'object') {
        for (const [k, v] of Object.entries(data)) {
          label = label.replace(new RegExp(`\\{${k}\\}`, 'g'), v);
        }
      }
      // if username placeholder still present, try to fill from URL
      if (label.includes('{username}')) {
        const uname = extractUsernameFromUrl(rawUrl) || (data && data.username) || rawUrl;
        label = label.replace(/\{username\}/g, uname || rawUrl);
      }
      return label.replace(/\{discriminator\}/g, (data && data.discriminator) || '');
    }

    function makeAnchor(iconNode, title, href) {
      const a = document.createElement('a');
      a.className = 'member-social-link';
      if (href && /^https?:\/\//i.test(href)) {
        a.href = href;
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
      } else {
        a.setAttribute('role', 'button');
        a.href = '#';
      }
      a.title = title || '';
      a.setAttribute('aria-label', title || '');
      if (iconNode) a.appendChild(iconNode);
      return a;
    }

    // Parse old but functional data-social string format (as fallback)
    function parseDataSocialString(raw) {
      const out = [];
      if (!raw) return out;
      const parts = raw.split(';').map(s => s.trim()).filter(Boolean);
      for (const p of parts) {
        const idx = p.indexOf(':');
        if (idx === -1) continue;
        const key = p.slice(0, idx).trim().toLowerCase();
        let rest = p.slice(idx + 1).trim();
        // allow inline icon param like "...;icon=https://..."
        let overrideIcon = null;
        const m = rest.match(/icon=(https?:\/\/\S+)/i);
        if (m) {
          overrideIcon = m[1].replace(/[),.]+$/, '');
          rest = rest.replace(m[0], '').trim().replace(/^[:;]+/, '');
        }
        out.push({ platform: key, url: rest || null, overrideIcon });
      }
      return out;
    }

    const fallbackMap = {
      github: 'ðŸ™',
      git: 'ðŸ™',
      discord: 'ðŸ’¬',
      dc: 'ðŸ’¬',
      instagram: 'ðŸ“¸',
      insta: 'ðŸ“¸',
      ig: 'ðŸ“¸',
      twitter: 'ðŸ¦',
      x: 'ðŸ¦',
      email: 'âœ‰ï¸',
      mail: 'âœ‰ï¸',
      gmail: 'âœ‰ï¸',
      linkedin: 'ðŸ’¼',
      blog: 'ðŸ“'
    };

    const cards = Array.from(document.querySelectorAll('.member-card'));
    for (const card of cards) {
      if (card.dataset.socialProcessed) continue;
      card.dataset.socialProcessed = '1';

      const container = document.createElement('div');
      container.className = 'member-social';
      card.appendChild(container);

      const tpl = card.querySelector('template.socials-data');
      let entries = [];
      if (tpl && tpl.innerHTML && tpl.innerHTML.trim()) {
        try {
          const parsed = JSON.parse(tpl.innerHTML);
          for (const [platform, pdata] of Object.entries(parsed)) {
            entries.push({ platform: platform.toLowerCase(), data: pdata });
          }
        } catch (e) {
          // if JSON fails, fallback to data-social attribute below, and also logs so if I notice this whoever pushed that faulty update (usually me) can be blamed
          console.error('socials-data JSON parse failed for card ', card, e);
        }
      }

      // fallback to legacy data-social attribute (format key:url;key:url:icon=imgUrl;)
      if (entries.length === 0) {
        const raw = card.getAttribute('data-social');
        if (raw) {
          const parsed = parseDataSocialString(raw);
          parsed.forEach(p => entries.push({ platform: p.platform, url: p.url, overrideIcon: p.overrideIcon }));
        }
      }

      const placeholders = [];
      for (let i = 0; i < entries.length; i++) {
        const ph = document.createElement('span');
        ph.className = 'member-social-placeholder';
        container.appendChild(ph);
        placeholders.push(ph);
      }

      (async () => {
        const nodes = [];
        for (const entry of entries) {
          try {
            const platform = (entry.platform || '').toLowerCase();
            const rawUrl = entry.url || (entry.data && entry.data.url) || null;
            const overrideIcon = entry.overrideIcon || (entry.data && entry.data.iconUrl) || null;
            const fallbackEmoji = {
              github: 'ðŸ™', discord: 'ðŸ’¬', instagram: 'ðŸ“¸', twitter: 'ðŸ¦', blog: 'ðŸ“'
            }[platform] || 'ðŸ”—';

            const iconNode = await createIconNode(rawUrl, overrideIcon, fallbackEmoji);

            // choose label using template JSON data or heuristics
            const label = formatLabel(platform, entry.data, rawUrl);

            const href = rawUrl && /^https?:\/\//i.test(rawUrl) ? rawUrl : null;
            const anchor = makeAnchor(iconNode, label, href);
            nodes.push(anchor);
          } catch (e) {
            console.error('Failed to create social node', e);
            nodes.push(null);
          }
        }

        // Replace placeholders
        nodes.forEach((n, idx) => {
          const ph = placeholders[idx];
          if (!ph) {
            if (n) container.appendChild(n);
            return;
          }
          if (n) ph.replaceWith(n);
          else ph.remove();
        });

        // if container empty afterwards, remove it
        if (!container.querySelector('.member-social-link')) container.remove();
      })();
    }
  }));
</script>
</body>
</html>
